<!DOCTYPE html>
<html>
<head>
  <title>Nós Dois Viajando</title>
  <link rel="shortcut icon" type="image/x-icon" href="icons/favicon.ico">
  <link rel="stylesheet" type="text/css" href="style.css" />
  <!-- Mobile redirect script by https://www.pagecrafter.com -->
  <script type="text/javascript" src="redirection-mobile.js"></script>
  <script type="text/javascript">// <![CDATA[
    SA.redirection_mobile ({
      mobile_url : "nos2viajando.travelmap.net",
    });
  // ]]></script>
  <script src="locations.js"></script>
  <script src="airports.js"></script>
  <script src="countries_bbox.js"></script>
  <script src='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css' rel='stylesheet' />
</head>
<body>


<div class="main-container">

  <div class="sidebar-container">

    <div class="top-container">
      <div class="avatar">
        <img class="avatar" src="avatar.jpg"/>
      </div>
      <div class="title">
        Nós Dois Viajando
      </div>
      <div class="distance">
        <img class="metric" src="icons/distance.svg"/> 57.341 km
      </div>
      <div class="days">
        <img class="metric" src="icons/days.svg"/> 58 dias
      </div>
      <div class="countries">
        <img class="metric" src="icons/world.svg"/> 7 países
      </div>
      <div class="map">
        <div id='map' style='width: 300px; height: 150px;'></div>
      </div>
      <div class="flags">
        <div id ='BR'><img class="flag" src="icons/flags/brazil.svg" title="Brasil" alt="Brasil"/></div>
        <div id ='AR'><img class="flag" src="icons/flags/argentina.svg" title="Argentina" alt="Argentina"/></div>
        <div id ='PY'><img class="flag" src="icons/flags/paraguay.svg" title="Paraguai" alt="Paraguai"/></div>
        <div id ='US'><img class="flag" src="icons/flags/united-states.svg" title="Estados Unidos" alt="Estados Unidos"/></div>
        <div id ='IT'><img class="flag" src="icons/flags/italy.svg" title="Itália" alt="Itália"/></div>
        <div id ='VA'><img class="flag" src="icons/flags/vatican.svg" title="Vaticano" alt="Vaticano"/></div>
        <div id ='HR'><img class="flag" src="icons/flags/croatia.svg" title="Croácia" alt="Croácia"/></div>
      </div>

    </div>

    <div class="middle-container">
    </div>

    <div class="bottom-container">
    </div>

  </div>

  <div class="map-container">
    <iframe src="https://nos2viajando.travelmap.net/" frameBorder="0" allowfullscreen >
      Navegador não compatível
    </iframe>
  </div>

</div>

<script>

  mapboxgl.accessToken = 'pk.eyJ1IjoiaGFyYWxkby1maWxobyIsImEiOiJja2Vha3RvcjQwMWw4Mzh0MzZzaGdqbXgxIn0.oRUG1yvJiEFcyjFcDqW89w';
  var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/light-v10'
  });

  var initial_bbox = [];
  var current_bbox = [];

  var west = 180;
  var south = 90;
  var east = -180;
  var north = -90;

  var lng_offset = 0;
  var lat_offset = 10;

  for (var i = 0; i < airports.length; i++) {

    new mapboxgl.Marker({color:'#A0A0A0',scale:0.3,draggable:false})
    .setLngLat(airports[i][0])
    .setPopup(new mapboxgl.Popup({closeButton:false}).setText(airports[i][1]))
    .addTo(map);

  }

  for (var i = 0; i < locations.length; i++) {

    new mapboxgl.Marker({scale:0.4,draggable:false})
    .setLngLat(locations[i][0])
    .setPopup(new mapboxgl.Popup({closeButton:false}).setText(locations[i][1]))
    .addTo(map);

    if (locations[i][0][0] < west) {
      west = locations[i][0][0];
    }
    if (locations[i][0][0] > east) {
      east = locations[i][0][0];
    }
    if (locations[i][0][1] < south) {
      south = locations[i][0][1];
    }
    if (locations[i][0][1] > north) {
      north = locations[i][0][1];
    }
    initial_bbox = [west, south, east, north];

  }

  initial_bbox[0] += lng_offset;
  initial_bbox[1] += lat_offset;
  initial_bbox[2] += lng_offset;
  initial_bbox[3] += lat_offset;

  map.fitBounds([
    [initial_bbox[0], initial_bbox[1]],
    [initial_bbox[2], initial_bbox[3]]],
    {padding: 30}
  );

  function fitRegion(region) {

    var bboxes = countries_bbox[region][1]

    var west = bboxes[0];
    var south = bboxes[1];
    var east = bboxes[2];
    var north = bboxes[3];

    map.fitBounds([
        [west, south],
        [east, north]],
        {padding: 5}
    );

  }

  document.getElementById('BR').addEventListener('click', function() { fitRegion('BR') });
  document.getElementById('AR').addEventListener('click', function() { fitRegion('AR') });
  document.getElementById('PY').addEventListener('click', function() { fitRegion('PY') });
  document.getElementById('US').addEventListener('click', function() { fitRegion('US') });
  document.getElementById('IT').addEventListener('click', function() { fitRegion('IT') });
  document.getElementById('VA').addEventListener('click', function() { fitRegion('VA') });
  document.getElementById('HR').addEventListener('click', function() { fitRegion('HR') });

</script>

</body>
</html>
